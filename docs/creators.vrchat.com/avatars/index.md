# 虚拟形象

::: danger 文档翻译未完成
该文档仅经过了简单翻译，没有进行校对和润色工作，其中的专有名词和表达可能有误。
:::

VRChat 允许您创建和上传自定义虚拟形象！

## 创建虚拟形象

要开始创建虚拟形象，请查看 [创建你的第一个虚拟形象](/creators.vrchat.com/avatars/creating-your-first-avatar)。

侧边栏上有一个完整的 `虚拟形象` 类别可供查看。下面是一些影响较大的重要页面：

- [Rig 要求](/creators.vrchat.com/avatars/rig-requirements) 解释了如何为 VRChat 设置自定义 3D 模型的层次结构。
- [虚拟形象性能排名系统](/creators.vrchat.com/avatars/avatar-performance-ranking-system) 解释了为什么有些虚拟形象的性能是"优秀"的，而有些是"非常差"的。
- [虚拟形象优化小贴士](/creators.vrchat.com/avatars/avatar-optimizing-tips) - 既然你已经知道了 _为什么_，那就来看看这个页面，学习如何增加帧数。
- 继续阅读本页，了解有关虚拟形象 3.0 SDK 重要概念的更多信息。

## 什么是虚拟形象 3.0？

**虚拟形象 3.0** 是我们为 VRChat 中的虚拟形象提供的所有功能的名称。虚拟形象 3.0 的功能主要集中在改进 VRChat 中虚拟形象的表达、性能和功能。

虚拟形象 3.0 与[操作菜单](/docs.vrchat.com/OVERVIEW/controls/action-menu)高度集成，用于控制您佩戴的虚拟形象并与之互动。在创建虚拟形象 3 虚拟形象之前，最好先进入并试用一下动作菜单！

## 准备工作

- [安装并设置 VRChat 虚拟形象 SDK](/creators.vrchat.com/sdk/)
- [创建第一个虚拟形象](/creators.vrchat.com/avatars/creating-your-first-avatar)

## 了解概念

为了理解和使用虚拟形象 3.0 系统，您需要了解一些概念。这些概念将帮助您了解虚拟形象的构造、如何以最佳方式构建虚拟形象以及各种系统的预期用途。

### Unity 系统

编写本文档时，我们假定您对 [Unity Animators](https://docs.unity3d.com/2019.4/Documentation/Manual/class-AnimatorController.html) 系统稍有了解。特别是，您应确保自己具备以下方面的基本工作知识：

- 动画师和动画
- 动画层、层权重和混合
- 状态和过渡
- 动画参数
- 状态行为
- Avatar 遮罩

了解以下内容也会有所帮助：

- 状态退出时间
- 动画的循环时间
- （进阶）图层间的时间同步
- （高级）混合树

### 基础

通过虚拟形象 3.0，您可以快速创建一个具有模拟眼球运动和视觉效果的基本虚拟形象。

1. 导入你的虚拟形象，设置为人形。设置材质等。
2. 添加 `Avatar Descriptor` 组件
3. 如果想要模拟眼球运动，请定义眼球骨骼。
4. 如果需要视觉效果，请定义视觉效果类型。在 `Rigging 配置界面` 中指定颚瓣骨，或通过形态键定义视觉效果。与虚拟形象 2.0 相同。
5. 设置视角。
6. 构建并上传！

如果您要制作非人形虚拟形象，请阅读下面的 [通用虚拟形象](#通用虚拟形象) 部分。

大功告成！这将创建一个具有默认手势和操作的基本虚拟形象。您可以利用一些内置功能，即使有人使用以某种方式命名的 形态键/骨骼来创建虚拟形象，您也将获得一些基本的虚拟形象 3.0 功能。

不过除了这些得到升级的基本系统，虚拟形象 3.0 还有一些新功能。

### 本地虚拟形象测试

有没有想过在不上传的情况下迭代和测试虚拟形象？有了虚拟形象 3.0，现在可以了！

在 VRChat SDK 控制面板的 `Builder` 选项卡中，您现在可以在 `Local Test` 部分选择 `Build and Test`。点击后，您的虚拟形象将会被构建并复制到一个文件夹中。

启动 VRChat 时，您可以在 `Avatars` 菜单的 `Others` 部分访问本地虚拟形象！只有你能看到它，但你可以对虚拟形象进行修改，再次点击 `Build and Test`，经过短暂的构建后，你的虚拟形象就会更新。只需在菜单中选择虚拟形象，然后再次点击 `Change`，您就会换上新的测试虚拟形象。

这个虚拟形象只对你可见！对其他人来说，你看起来就像换成本地测试虚拟形象之前的虚拟形象。对于我们的虚拟形象 3.0 测试人员来说，这让迭代速度快了很多。希望您喜欢！

要删除复制的本地测试虚拟形象，请进入 VRChat SDK 控制面板的 "内容管理器 "选项卡。您将在底部的 "测试虚拟形象 "部分看到您的虚拟形象。点击 "删除"，当您重新打开虚拟形象菜单时，它将从 "其他 "部分消失。

### 模拟眼球运动

模拟眼动是指你的眼睛会四处移动，观察周围的事物。这不是"眼动追踪"，因为我们没有办法让你从眼动追踪设备中输入数据，但这是让你的虚拟形象看起来更"活灵活现"的好办法。

你可以在编辑器中预览你的设置，并调整虚拟形象的眼睛在各种状态下的外观，这些状态用于决定你的眼骨是如何设置的。

眨眼可以通过形态键或骨骼来处理。形态键是常用的方法，但我们也加入了骨骼，以便进行更多设置。

眨眼的形态键由以下三种形态键定义：

- `Blink` - 双眼眨眼
- `LookUp` - 向上看时使用的形态键——用它来调整眼睛/虹膜/眼睑/眉毛的位置
- `LookDown` - 向下看时使用的混合效果，使用方法与 `LookUp` 相似

如果不想使用，可以将 `LookUp` 和 `LookDown` 设置为 `none`。

此外，你还会注意到两个滑块————一个是从 "冷静" 到 "兴奋"，另一个是从 "害羞" 到 "自信"。冷静/兴奋会影响你眨眼的频率。害羞/自信会影响你看其他玩家的频率，以及你的视线在其他玩家脸上停留的时间，直到你移开视线。

当我们谈到状态行为时，您会了解到更多这方面的信息，但您可以在动画器中设置状态，以便在达到该状态时**禁用眼睛动画**。这样设置后，你就不必担心因为 "快乐" 的心情而闭上眼睛，但眨眼动作仍在进行，从而导致形态键被过度驱动。

### 形态键/基于骨骼的嘴型

如果您只想使用标准的颚骨或形态键视觉效果，我们会为您提供帮助。这两种视觉效果都依然存在，而且运行良好。

此外，您现在还可以配置颚瓣骨视觉特效的角度，进行额外的自定义！

不过，在虚拟形象 3.0 中，您还可以访问动画参数，该参数可指示当前应播放哪个虚拟形象！这就意味着，只要你能制作动画，**你就能在虚拟形象中使用它。** 不再需要为二维嘴巴、机器人或其他任何东西耍花招——你可以为虚拟形象制作任何你喜欢的动画。

在所有虚拟形象模式中，"虚拟形象" 动画参数都会更新。

### 代理动画

您可能会注意到，SDK 包含大量名为 `proxy_animationName` 的动画。这些动画是各种默认 VRChat 动画的 "占位符"。如果您使用了以 `proxy_` 开头的动画，VRChat 会尝试用内置动画替换它。这可以在任何可播放层中进行。

虽然如果前缀为 `proxy_` 的动画后缀与我们的内置动画不匹配，我们将不会替换该动画，但最好还是避免将任何动画命名为前缀为 `proxy_` 的动画。

### 使用自动脚步

这是虚拟形象 3.0 Avatar Descriptor 中的一个选项。默认为开启。

**使用自动脚步** 仅适用于 3 点或 4 点跟踪。关闭该选项意味着您将禁用用于房间尺度移动的程序化下半身动画。在三点或四点追踪模式下，当您在房间空间中移动时，程序动画就会播放。

如果开启自动脚步（默认状态），则仍可通过 `追踪控制` 状态行为启用/禁用追踪。

如果 `自动脚步` 处于关闭状态，则启用/禁用腿部和髋部的追踪功能将不起任何作用，您将始终依靠动画来驱动下半身。

#### 被动运动动画

这是虚拟形象 3.0 Avatar Descriptor 中的一个选项。默认为开启。

**被动运动动画** 默认为开启。它仅适用于 6 点跟踪（全身跟踪）。当 `运动动画` 开启时，在全身追踪中运动（如移动操纵杆）将播放由基础可玩层决定的行走/奔跑动画。

当 `运动动画` 关闭时，在全身追踪中移动将不会播放行走/奔跑动画。如果您希望用全身追踪动作来 `模仿` 您的行走，这将非常有用。**如果要关闭 "运动动画"，请不要使用默认的基础层和添加层！**

### 写入默认状态

[写入默认值](https://docs.unity3d.com/2019.4/Documentation/Manual/class-State.html) 是 Unity 中动画器状态的一个选项。

写入默认值"（Write Defaults）"开 "时，将写回在该特定状态下没有动画的**所有动画属性**（_在整个控制器的基础上！_）的默认值。如果您没有计划好，这可能会导致一些非常奇怪的交互。

Unity 在向 5.0 版迁移时添加了这一功能。这样做是为了避免依赖于写入所有默认属性行为的已有资产和项目发生故障。

通常情况下，当你与其他游戏开发者在一个项目上合作时，你们会商定一个标准。在 VRChat，我们都是游戏开发者，因此我们必须在这里设定标准。

VRChat 在内置动画器和示例动画器中不使用 "写入默认值"（Write Defaults）。这意味着只有动画中的实际属性才会被任何一个动画器节点播放。我们建议创作者也遵循这一工作流程，因为这样更容易跟踪哪些属性将通过任何特定层播放动画，而且也符合整个 Unity 的预期用途。

创建新节点时，"写入默认值"（Write Defaults）默认为**开**，因此创作者必须知道他们必须取消选中此值。如果您想使用 "写入默认值"，就必须跟踪启用该选项的节点可能写入的所有属性。

**我们建议将 "写入默认值 "功能关闭，并明确动画器需要设置的任何参数。**请注意，这可能需要添加 "重置 "动画，或在动画中添加属性，以便在特定方向上 "初始化 "变换。

综上所述，如果你要使用更高级的用例和设置，使用 "写入默认值 "可能会更有优势。

#### 通用虚拟形象

虚拟形象 3.0 也支持非人类的通用虚拟形象。如果您想使用虚拟形象 3.0 人形模型的类似功能，您需要遵循以下几条准则：

- 将通用模型导入 FBX，并将其指定为 `通用` Rig 类型，这样就创建了一个虚拟形象对象
- 确保虚拟形象对象在动画器组件的虚拟形象字段中被引用（与虚拟形象描述符相同的游戏对象）。
- 将动画器控制器留空（运行时会被剥离），并使用 "可播放层 "来定义您的自定义动画控制器。通用虚拟形象有 3 个可播放层： 基础层、动作层和特效层，因为其他层是人形特有的。

如果不按照这些步骤操作，您的通用虚拟形象将无法使用许多 Avatars 3.0 功能，如表情参数和状态行为。如果您不介意，可以直接在根动画器中添加一个动画控制器，将虚拟形象字段留空。如果您只是在 Unity 中构建一个静态对象的层次结构，并想要一个简单的动画器，那么这种方法可能会很有用。